<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MasterFOC: control.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">MasterFOC<span id="projectnumber">&#160;0.0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">control.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;stm32f4xx_hal.h&quot;</code><br />
<code>#include &quot;arm_math.h&quot;</code><br />
<code>#include &quot;tim.h&quot;</code><br />
<code>#include &quot;stdio.h&quot;</code><br />
</div>
<p><a href="control_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_components.html">Components</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Coordinates components structure.  <a href="struct_components.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_p_i_d__para.html">PID_para</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">PID parameter structure.  <a href="struct_p_i_d__para.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_motor.html">Motor</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="struct_motor.html" title="Motor parameter structure.">Motor</a> parameter structure.  <a href="struct_motor.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a1daf785e3f68d293c7caa1c756d5cb74"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a>&#160;&#160;&#160;3.14159265359f</td></tr>
<tr class="separator:a1daf785e3f68d293c7caa1c756d5cb74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c7cca717941f9eb5c7f90f44ac8746b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a4c7cca717941f9eb5c7f90f44ac8746b">SQRT_3</a>&#160;&#160;&#160;1.7320508f</td></tr>
<tr class="separator:a4c7cca717941f9eb5c7f90f44ac8746b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec2a4da8c1ff32ae0a52daebe3fe6d00"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#aec2a4da8c1ff32ae0a52daebe3fe6d00">UnitPulse</a>&#160;&#160;&#160;4096</td></tr>
<tr class="separator:aec2a4da8c1ff32ae0a52daebe3fe6d00"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a646bef2e4e0d58c4b2a1c3d3037475a4"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct_components.html">Components</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a646bef2e4e0d58c4b2a1c3d3037475a4">Coordinates</a></td></tr>
<tr class="memdesc:a646bef2e4e0d58c4b2a1c3d3037475a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Coordinates components structure.  <a href="control_8h.html#a646bef2e4e0d58c4b2a1c3d3037475a4">More...</a><br /></td></tr>
<tr class="separator:a646bef2e4e0d58c4b2a1c3d3037475a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7381bd99b9f8d665d55ffc97eedc9e9d"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct_p_i_d__para.html">PID_para</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a7381bd99b9f8d665d55ffc97eedc9e9d">PID_para</a></td></tr>
<tr class="memdesc:a7381bd99b9f8d665d55ffc97eedc9e9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">PID parameter structure.  <a href="control_8h.html#a7381bd99b9f8d665d55ffc97eedc9e9d">More...</a><br /></td></tr>
<tr class="separator:a7381bd99b9f8d665d55ffc97eedc9e9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7041679f372ba53525b1eaed6001e67a"><td class="memItemLeft" align="right" valign="top">typedef enum <a class="el" href="control_8h.html#aee3ea37f4f505980157cf93a84687bcb">ControlMode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a7041679f372ba53525b1eaed6001e67a">ControlMode</a></td></tr>
<tr class="memdesc:a7041679f372ba53525b1eaed6001e67a"><td class="mdescLeft">&#160;</td><td class="mdescRight">ControlMode enumerator.  <a href="control_8h.html#a7041679f372ba53525b1eaed6001e67a">More...</a><br /></td></tr>
<tr class="separator:a7041679f372ba53525b1eaed6001e67a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05445b981aabc15fe58b2aa04cc007be"><td class="memItemLeft" align="right" valign="top">typedef enum <a class="el" href="control_8h.html#ab8fd4796026dfcd8e06f047989acb66a">UserAPP</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a05445b981aabc15fe58b2aa04cc007be">UserAPP</a></td></tr>
<tr class="memdesc:a05445b981aabc15fe58b2aa04cc007be"><td class="mdescLeft">&#160;</td><td class="mdescRight">UserAPP enumerator.  <a href="control_8h.html#a05445b981aabc15fe58b2aa04cc007be">More...</a><br /></td></tr>
<tr class="separator:a05445b981aabc15fe58b2aa04cc007be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7c4fecf4e12490cdae6a6a0abd3959e"><td class="memItemLeft" align="right" valign="top">typedef enum <a class="el" href="control_8h.html#a4fe62c345b7ce33aac126a260c5a82fb">DRV_GAIN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#aa7c4fecf4e12490cdae6a6a0abd3959e">DRV_GAIN</a></td></tr>
<tr class="memdesc:aa7c4fecf4e12490cdae6a6a0abd3959e"><td class="mdescLeft">&#160;</td><td class="mdescRight">DRV8302 amplification gain enumerator.  <a href="control_8h.html#aa7c4fecf4e12490cdae6a6a0abd3959e">More...</a><br /></td></tr>
<tr class="separator:aa7c4fecf4e12490cdae6a6a0abd3959e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:aee3ea37f4f505980157cf93a84687bcb"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#aee3ea37f4f505980157cf93a84687bcb">ControlMode</a> { <a class="el" href="control_8h.html#aee3ea37f4f505980157cf93a84687bcbad3fa9ae9431d6cb1772f9d9df48cab19">Idle</a> = 0
, <a class="el" href="control_8h.html#aee3ea37f4f505980157cf93a84687bcba2891de101c03df22f3bf8137f8622908">Speed</a>
, <a class="el" href="control_8h.html#aee3ea37f4f505980157cf93a84687bcba0ca2444163688098d8e674e31fb11397">Position</a>
, <a class="el" href="control_8h.html#aee3ea37f4f505980157cf93a84687bcbaa1ffbb212863410b17ce950709b7caa1">Torque</a>
 }</td></tr>
<tr class="memdesc:aee3ea37f4f505980157cf93a84687bcb"><td class="mdescLeft">&#160;</td><td class="mdescRight">ControlMode enumerator.  <a href="control_8h.html#aee3ea37f4f505980157cf93a84687bcb">More...</a><br /></td></tr>
<tr class="separator:aee3ea37f4f505980157cf93a84687bcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8fd4796026dfcd8e06f047989acb66a"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#ab8fd4796026dfcd8e06f047989acb66a">UserAPP</a> { <a class="el" href="control_8h.html#ab8fd4796026dfcd8e06f047989acb66aacc842255ac43e600deac25fefd0fdb0a">Drag</a> = 1
, <a class="el" href="control_8h.html#ab8fd4796026dfcd8e06f047989acb66aa436ecffb0346b444ef8e03489844ebf3">ForceFeedback</a>
, <a class="el" href="control_8h.html#ab8fd4796026dfcd8e06f047989acb66aaab57132cff95cd4bb6b65a486c127dfb">Switch</a>
, <a class="el" href="control_8h.html#ab8fd4796026dfcd8e06f047989acb66aae72db1ad60dbc5ad7dbcb42d6035038f">SpaceWalk</a>
 }</td></tr>
<tr class="memdesc:ab8fd4796026dfcd8e06f047989acb66a"><td class="mdescLeft">&#160;</td><td class="mdescRight">UserAPP enumerator.  <a href="control_8h.html#ab8fd4796026dfcd8e06f047989acb66a">More...</a><br /></td></tr>
<tr class="separator:ab8fd4796026dfcd8e06f047989acb66a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fe62c345b7ce33aac126a260c5a82fb"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a4fe62c345b7ce33aac126a260c5a82fb">DRV_GAIN</a> { <a class="el" href="control_8h.html#a4fe62c345b7ce33aac126a260c5a82fba30f3f2fba31dab5fa94c1979df5b3648">DRV_GAIN_10</a> = 0
, <a class="el" href="control_8h.html#a4fe62c345b7ce33aac126a260c5a82fba003ad48d1b5cdccf078d183a8ebb6660">DRV_GAIN_40</a>
 }</td></tr>
<tr class="memdesc:a4fe62c345b7ce33aac126a260c5a82fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">DRV8302 amplification gain enumerator.  <a href="control_8h.html#a4fe62c345b7ce33aac126a260c5a82fb">More...</a><br /></td></tr>
<tr class="separator:a4fe62c345b7ce33aac126a260c5a82fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a10d4a5658201a6cb630bbe063d898472"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a10d4a5658201a6cb630bbe063d898472">MotorInit</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle, ADC_HandleTypeDef hadc, TIM_HandleTypeDef hDriver, TIM_HandleTypeDef hEncoder, I2C_HandleTypeDef hIICEncoder, <a class="el" href="control_8h.html#aee3ea37f4f505980157cf93a84687bcb">ControlMode</a> mode)</td></tr>
<tr class="memdesc:a10d4a5658201a6cb630bbe063d898472"><td class="mdescLeft">&#160;</td><td class="mdescRight">: <a class="el" href="struct_motor.html" title="Motor parameter structure.">Motor</a> initialization function  <a href="control_8h.html#a10d4a5658201a6cb630bbe063d898472">More...</a><br /></td></tr>
<tr class="separator:a10d4a5658201a6cb630bbe063d898472"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ca0cc7c05bfaf12c86799a2d71c8ede"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a9ca0cc7c05bfaf12c86799a2d71c8ede">ModeSelection</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle, <a class="el" href="control_8h.html#aee3ea37f4f505980157cf93a84687bcb">ControlMode</a> mode)</td></tr>
<tr class="memdesc:a9ca0cc7c05bfaf12c86799a2d71c8ede"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Mode selection function  <a href="control_8h.html#a9ca0cc7c05bfaf12c86799a2d71c8ede">More...</a><br /></td></tr>
<tr class="separator:a9ca0cc7c05bfaf12c86799a2d71c8ede"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a503ae511083e4a1a1c330a01cd21cf1a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a503ae511083e4a1a1c330a01cd21cf1a">UserAPPSelection</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle, <a class="el" href="control_8h.html#ab8fd4796026dfcd8e06f047989acb66a">UserAPP</a> app)</td></tr>
<tr class="memdesc:a503ae511083e4a1a1c330a01cd21cf1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">: user application selection function  <a href="control_8h.html#a503ae511083e4a1a1c330a01cd21cf1a">More...</a><br /></td></tr>
<tr class="separator:a503ae511083e4a1a1c330a01cd21cf1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74b8d54f398d5cace9878611ddda252b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a74b8d54f398d5cace9878611ddda252b">EnableGate</a> (void)</td></tr>
<tr class="memdesc:a74b8d54f398d5cace9878611ddda252b"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Pull up the ENGATE pin of the DRV8302 to activate the gate  <a href="control_8h.html#a74b8d54f398d5cace9878611ddda252b">More...</a><br /></td></tr>
<tr class="separator:a74b8d54f398d5cace9878611ddda252b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adab12f80393f46ebe1732964a965ffff"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#adab12f80393f46ebe1732964a965ffff">GainSelection</a> (<a class="el" href="control_8h.html#a4fe62c345b7ce33aac126a260c5a82fb">DRV_GAIN</a> gain)</td></tr>
<tr class="memdesc:adab12f80393f46ebe1732964a965ffff"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Select the gain of the buit-in amplifier of DRV8302 If GAIN = LOW, the internal current shunt amplifiers have a gain of 10V/V. If GAIN = HIGH, the current shunt amplifiers have a gain of 40V/V  <a href="control_8h.html#adab12f80393f46ebe1732964a965ffff">More...</a><br /></td></tr>
<tr class="separator:adab12f80393f46ebe1732964a965ffff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eb418de90bcd7d3f2faf0075c9d88f3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a7eb418de90bcd7d3f2faf0075c9d88f3">DC_Calibration</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle)</td></tr>
<tr class="memdesc:a7eb418de90bcd7d3f2faf0075c9d88f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Calibrate the DC offset of the current shunt amplifier should be called after <a class="el" href="control_8h.html#a74b8d54f398d5cace9878611ddda252b" title=": Pull up the ENGATE pin of the DRV8302 to activate the gate">EnableGate()</a>  <a href="control_8h.html#a7eb418de90bcd7d3f2faf0075c9d88f3">More...</a><br /></td></tr>
<tr class="separator:a7eb418de90bcd7d3f2faf0075c9d88f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21066fe1f928c7c279fbcab34c8d094b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a21066fe1f928c7c279fbcab34c8d094b">SetMotorParam</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle, uint8_t DC_supply, uint8_t phase, uint8_t polePairs, float MaxCurrent, float MaxSpeed)</td></tr>
<tr class="memdesc:a21066fe1f928c7c279fbcab34c8d094b"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Set motor parameters  <a href="control_8h.html#a21066fe1f928c7c279fbcab34c8d094b">More...</a><br /></td></tr>
<tr class="separator:a21066fe1f928c7c279fbcab34c8d094b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16576dccb7e1137b80a15a0259b77eb6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a16576dccb7e1137b80a15a0259b77eb6">calcAngle</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle)</td></tr>
<tr class="memdesc:a16576dccb7e1137b80a15a0259b77eb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">: [Auxiliary Debug Function] calculate electric angle from Valpha and Vbeta  <a href="control_8h.html#a16576dccb7e1137b80a15a0259b77eb6">More...</a><br /></td></tr>
<tr class="separator:a16576dccb7e1137b80a15a0259b77eb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa05889183d3dd27313d91a9f5c6105e9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#aa05889183d3dd27313d91a9f5c6105e9">MotorCalibration</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle)</td></tr>
<tr class="memdesc:aa05889183d3dd27313d91a9f5c6105e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Calibrate motor when power on Measure the angle offset between encoder 0 deg and motor electrical 0 deg(phase a 100%) Angle_E = (Angle_M - Offset)*nPolePairs  <a href="control_8h.html#aa05889183d3dd27313d91a9f5c6105e9">More...</a><br /></td></tr>
<tr class="separator:aa05889183d3dd27313d91a9f5c6105e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86ebf8db552e7de7117d19c4b32ce6af"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a86ebf8db552e7de7117d19c4b32ce6af">MotorOpenLoop</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle)</td></tr>
<tr class="memdesc:a86ebf8db552e7de7117d19c4b32ce6af"><td class="mdescLeft">&#160;</td><td class="mdescRight">: openloop drag control  <a href="control_8h.html#a86ebf8db552e7de7117d19c4b32ce6af">More...</a><br /></td></tr>
<tr class="separator:a86ebf8db552e7de7117d19c4b32ce6af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b27b50e40405c6fc149078e10387372"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a0b27b50e40405c6fc149078e10387372">ADCSample</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle)</td></tr>
<tr class="memdesc:a0b27b50e40405c6fc149078e10387372"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Current sampling function, once called, retrieve one set of sampled data from DMA Data stored in mHandle-&gt;Current called in timer callback function every control period  <a href="control_8h.html#a0b27b50e40405c6fc149078e10387372">More...</a><br /></td></tr>
<tr class="separator:a0b27b50e40405c6fc149078e10387372"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a4f56dcb39e5926827ed0907e6a8459"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a8a4f56dcb39e5926827ed0907e6a8459">ADCFilter</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle)</td></tr>
<tr class="memdesc:a8a4f56dcb39e5926827ed0907e6a8459"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Filter the sampled current  <a href="control_8h.html#a8a4f56dcb39e5926827ed0907e6a8459">More...</a><br /></td></tr>
<tr class="separator:a8a4f56dcb39e5926827ed0907e6a8459"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6907fe9118a5749f9ef88ccc2888fc5d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a6907fe9118a5749f9ef88ccc2888fc5d">CurrentReconstruction</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle)</td></tr>
<tr class="memdesc:a6907fe9118a5749f9ef88ccc2888fc5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Reconstruct the sampled current from 2 phases to three phases  <a href="control_8h.html#a6907fe9118a5749f9ef88ccc2888fc5d">More...</a><br /></td></tr>
<tr class="separator:a6907fe9118a5749f9ef88ccc2888fc5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a121e9fcddd5f7811aeeccb023ab60751"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a121e9fcddd5f7811aeeccb023ab60751">getEangle</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle)</td></tr>
<tr class="memdesc:a121e9fcddd5f7811aeeccb023ab60751"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Calculate electric angle from mechanical angle, store in mHandle-&gt;E_angle  <a href="control_8h.html#a121e9fcddd5f7811aeeccb023ab60751">More...</a><br /></td></tr>
<tr class="separator:a121e9fcddd5f7811aeeccb023ab60751"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f371a9588ee8097b54b5893c53a310c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a3f371a9588ee8097b54b5893c53a310c">getSpeed</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle)</td></tr>
<tr class="memdesc:a3f371a9588ee8097b54b5893c53a310c"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Calculate the motor speed in rpm, store in mHandle-&gt;speed  <a href="control_8h.html#a3f371a9588ee8097b54b5893c53a310c">More...</a><br /></td></tr>
<tr class="separator:a3f371a9588ee8097b54b5893c53a310c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a378d01f7b019cd1abfe5745c3c0c5e1f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a378d01f7b019cd1abfe5745c3c0c5e1f">ClarkeTransform</a> (<a class="el" href="control_8h.html#a646bef2e4e0d58c4b2a1c3d3037475a4">Coordinates</a> *pComponents)</td></tr>
<tr class="memdesc:a378d01f7b019cd1abfe5745c3c0c5e1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Clarke Transformation function, convert abc to alpha beta  <a href="control_8h.html#a378d01f7b019cd1abfe5745c3c0c5e1f">More...</a><br /></td></tr>
<tr class="separator:a378d01f7b019cd1abfe5745c3c0c5e1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78b6d2cd4422b49b7ea838ce02d4bbcd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a78b6d2cd4422b49b7ea838ce02d4bbcd">ParkTransform</a> (<a class="el" href="control_8h.html#a646bef2e4e0d58c4b2a1c3d3037475a4">Coordinates</a> *pComponents, int theta)</td></tr>
<tr class="memdesc:a78b6d2cd4422b49b7ea838ce02d4bbcd"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Park Transformation function, convert alpha, beta to d, q Original park: q leads d axis by 90 deg Modified park: d leads q axis by 90 deg  <a href="control_8h.html#a78b6d2cd4422b49b7ea838ce02d4bbcd">More...</a><br /></td></tr>
<tr class="separator:a78b6d2cd4422b49b7ea838ce02d4bbcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7658aa110661b90ebb23f29cfbc73b92"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a7658aa110661b90ebb23f29cfbc73b92">InvPark</a> (<a class="el" href="control_8h.html#a646bef2e4e0d58c4b2a1c3d3037475a4">Coordinates</a> *pComponents, int theta)</td></tr>
<tr class="memdesc:a7658aa110661b90ebb23f29cfbc73b92"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Inverse Park Transformation function, convert d, q to alpha, beta Original park: q leads d axis by 90 deg Modified park: d leads q axis by 90 deg  <a href="control_8h.html#a7658aa110661b90ebb23f29cfbc73b92">More...</a><br /></td></tr>
<tr class="separator:a7658aa110661b90ebb23f29cfbc73b92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96353709b0ece65a0f458f13f7ebd35b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a96353709b0ece65a0f458f13f7ebd35b">GetSector</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle)</td></tr>
<tr class="memdesc:a96353709b0ece65a0f458f13f7ebd35b"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Calculate the sector of the target space voltage vector  <a href="control_8h.html#a96353709b0ece65a0f458f13f7ebd35b">More...</a><br /></td></tr>
<tr class="separator:a96353709b0ece65a0f458f13f7ebd35b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39d7de953ea95e29b89b7294a304fca1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a39d7de953ea95e29b89b7294a304fca1">ModulationLimit</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle)</td></tr>
<tr class="memdesc:a39d7de953ea95e29b89b7294a304fca1"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Overmodulation limiting function, prevent overmodulation  <a href="control_8h.html#a39d7de953ea95e29b89b7294a304fca1">More...</a><br /></td></tr>
<tr class="separator:a39d7de953ea95e29b89b7294a304fca1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf18f98940d1b08559520b06d6ff405c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#adf18f98940d1b08559520b06d6ff405c">SetSVPWM</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle)</td></tr>
<tr class="memdesc:adf18f98940d1b08559520b06d6ff405c"><td class="mdescLeft">&#160;</td><td class="mdescRight">: MOSFET dwelling time calculation function, to generate SVPWM  <a href="control_8h.html#adf18f98940d1b08559520b06d6ff405c">More...</a><br /></td></tr>
<tr class="separator:adf18f98940d1b08559520b06d6ff405c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cde34a6778b1b8e9d106a8b94405cd2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a5cde34a6778b1b8e9d106a8b94405cd2">dq2SVPWM</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle)</td></tr>
<tr class="memdesc:a5cde34a6778b1b8e9d106a8b94405cd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Generate SVPWM directly from dq voltage  <a href="control_8h.html#a5cde34a6778b1b8e9d106a8b94405cd2">More...</a><br /></td></tr>
<tr class="separator:a5cde34a6778b1b8e9d106a8b94405cd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84d9a96ad0f0c9549bb4d32581957441"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a84d9a96ad0f0c9549bb4d32581957441">SetCurrentPID</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle, float kp, float ki, float kd)</td></tr>
<tr class="memdesc:a84d9a96ad0f0c9549bb4d32581957441"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Set PID parameters of both d,q current loop  <a href="control_8h.html#a84d9a96ad0f0c9549bb4d32581957441">More...</a><br /></td></tr>
<tr class="separator:a84d9a96ad0f0c9549bb4d32581957441"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c1255dcaf68017b30f5d2132e2a5a6d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a9c1255dcaf68017b30f5d2132e2a5a6d">SetSpeedPID</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle, float kp, float ki, float kd, float outMax)</td></tr>
<tr class="memdesc:a9c1255dcaf68017b30f5d2132e2a5a6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Set speed loop PID parameters and the speed limit  <a href="control_8h.html#a9c1255dcaf68017b30f5d2132e2a5a6d">More...</a><br /></td></tr>
<tr class="separator:a9c1255dcaf68017b30f5d2132e2a5a6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac84226769ac245e2efd1ad7811489a68"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#ac84226769ac245e2efd1ad7811489a68">SetCurrentTarget</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle, float idTarget, float iqTarget)</td></tr>
<tr class="memdesc:ac84226769ac245e2efd1ad7811489a68"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Set target id, iq  <a href="control_8h.html#ac84226769ac245e2efd1ad7811489a68">More...</a><br /></td></tr>
<tr class="separator:ac84226769ac245e2efd1ad7811489a68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa16906f85af7a938b4cecb1b76953762"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#aa16906f85af7a938b4cecb1b76953762">SetSpeedTarget</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle, float Target)</td></tr>
<tr class="memdesc:aa16906f85af7a938b4cecb1b76953762"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Set target motor speed, with over speed limit  <a href="control_8h.html#aa16906f85af7a938b4cecb1b76953762">More...</a><br /></td></tr>
<tr class="separator:aa16906f85af7a938b4cecb1b76953762"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a412e84f409f4dc2bfbc19a3eccca4570"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a412e84f409f4dc2bfbc19a3eccca4570">IdPID</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle)</td></tr>
<tr class="memdesc:a412e84f409f4dc2bfbc19a3eccca4570"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Current loop Id PID calculation, calculate target Vd from Id with current kalman filter, integral limiter, and over voltage limiter  <a href="control_8h.html#a412e84f409f4dc2bfbc19a3eccca4570">More...</a><br /></td></tr>
<tr class="separator:a412e84f409f4dc2bfbc19a3eccca4570"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2773bdccd83bd5da909b5578439d569b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a2773bdccd83bd5da909b5578439d569b">IqPID</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle)</td></tr>
<tr class="memdesc:a2773bdccd83bd5da909b5578439d569b"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Current loop Iq PID calculation, calculate target Vq from Iq with current kalman filter, integral limiter, and over voltage limiter  <a href="control_8h.html#a2773bdccd83bd5da909b5578439d569b">More...</a><br /></td></tr>
<tr class="separator:a2773bdccd83bd5da909b5578439d569b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d7728f0aacb1fbae2a6accff6ae7f09"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a7d7728f0aacb1fbae2a6accff6ae7f09">SpeedPID</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle)</td></tr>
<tr class="memdesc:a7d7728f0aacb1fbae2a6accff6ae7f09"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Speed loop PID calculation, set target Id = 0, calculate target Iq from speed with integral limiter, and over current limiter  <a href="control_8h.html#a7d7728f0aacb1fbae2a6accff6ae7f09">More...</a><br /></td></tr>
<tr class="separator:a7d7728f0aacb1fbae2a6accff6ae7f09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06324f7942b9d7b3b74ce9eae71dad39"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a06324f7942b9d7b3b74ce9eae71dad39">AnglePID</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle)</td></tr>
<tr class="memdesc:a06324f7942b9d7b3b74ce9eae71dad39"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Angle loop PID calculation, calculate target speed with integral limiter  <a href="control_8h.html#a06324f7942b9d7b3b74ce9eae71dad39">More...</a><br /></td></tr>
<tr class="separator:a06324f7942b9d7b3b74ce9eae71dad39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88ae85a44012b8f171bd1fcd4064ace0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a88ae85a44012b8f171bd1fcd4064ace0">SetAnglePID</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle, float kp, float ki, float kd)</td></tr>
<tr class="memdesc:a88ae85a44012b8f171bd1fcd4064ace0"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Set angle loop PID parameters  <a href="control_8h.html#a88ae85a44012b8f171bd1fcd4064ace0">More...</a><br /></td></tr>
<tr class="separator:a88ae85a44012b8f171bd1fcd4064ace0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5d2a006a653c2eb76f455b9277d8729"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#ad5d2a006a653c2eb76f455b9277d8729">SetAngleTarget</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle, float Target)</td></tr>
<tr class="memdesc:ad5d2a006a653c2eb76f455b9277d8729"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Set absolute target angle, only single-turn (0-360 deg)  <a href="control_8h.html#ad5d2a006a653c2eb76f455b9277d8729">More...</a><br /></td></tr>
<tr class="separator:ad5d2a006a653c2eb76f455b9277d8729"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8db1fd960af01c3aa2bfb514e1def9d5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a8db1fd960af01c3aa2bfb514e1def9d5">SetIncrementAngle</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle, float Target)</td></tr>
<tr class="memdesc:a8db1fd960af01c3aa2bfb514e1def9d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Set increment target angle, the incremental angle is also restricted in (0-360 deg)  <a href="control_8h.html#a8db1fd960af01c3aa2bfb514e1def9d5">More...</a><br /></td></tr>
<tr class="separator:a8db1fd960af01c3aa2bfb514e1def9d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3833cbec98df3e6c130c4841b8401d70"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a3833cbec98df3e6c130c4841b8401d70">FOC</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle)</td></tr>
<tr class="memdesc:a3833cbec98df3e6c130c4841b8401d70"><td class="mdescLeft">&#160;</td><td class="mdescRight">: FOC loop funtion, including electric angle conversion, phase current filtering, Clarke/Park transformation, PID calculation, and SVPWM generation Called in ADC_DMA callback every control period  <a href="control_8h.html#a3833cbec98df3e6c130c4841b8401d70">More...</a><br /></td></tr>
<tr class="separator:a3833cbec98df3e6c130c4841b8401d70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d782bbdb4cf49779abe695b1bc32b43"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a8d782bbdb4cf49779abe695b1bc32b43">FOCcheck</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle)</td></tr>
<tr class="memdesc:a8d782bbdb4cf49779abe695b1bc32b43"><td class="mdescLeft">&#160;</td><td class="mdescRight">: [Auxiliary Debug Function] call to print FOC PID parameters  <a href="control_8h.html#a8d782bbdb4cf49779abe695b1bc32b43">More...</a><br /></td></tr>
<tr class="separator:a8d782bbdb4cf49779abe695b1bc32b43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4de542701bd589dcf40374765b978a2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#ae4de542701bd589dcf40374765b978a2">GetSVPWM</a> (<a class="el" href="struct_motor.html">Motor</a> *mHandle)</td></tr>
<tr class="memdesc:ae4de542701bd589dcf40374765b978a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Original SVPWM calculation function using complex numbers, slow  <a href="control_8h.html#ae4de542701bd589dcf40374765b978a2">More...</a><br /></td></tr>
<tr class="separator:ae4de542701bd589dcf40374765b978a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a1daf785e3f68d293c7caa1c756d5cb74" name="a1daf785e3f68d293c7caa1c756d5cb74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1daf785e3f68d293c7caa1c756d5cb74">&#9670;&#160;</a></span>pi</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define pi&#160;&#160;&#160;3.14159265359f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="control_8h_source.html#l00029">29</a> of file <a class="el" href="control_8h_source.html">control.h</a>.</p>

</div>
</div>
<a id="a4c7cca717941f9eb5c7f90f44ac8746b" name="a4c7cca717941f9eb5c7f90f44ac8746b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c7cca717941f9eb5c7f90f44ac8746b">&#9670;&#160;</a></span>SQRT_3</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SQRT_3&#160;&#160;&#160;1.7320508f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="control_8h_source.html#l00030">30</a> of file <a class="el" href="control_8h_source.html">control.h</a>.</p>

</div>
</div>
<a id="aec2a4da8c1ff32ae0a52daebe3fe6d00" name="aec2a4da8c1ff32ae0a52daebe3fe6d00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec2a4da8c1ff32ae0a52daebe3fe6d00">&#9670;&#160;</a></span>UnitPulse</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UnitPulse&#160;&#160;&#160;4096</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="control_8h_source.html#l00031">31</a> of file <a class="el" href="control_8h_source.html">control.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a7041679f372ba53525b1eaed6001e67a" name="a7041679f372ba53525b1eaed6001e67a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7041679f372ba53525b1eaed6001e67a">&#9670;&#160;</a></span>ControlMode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef enum <a class="el" href="control_8h.html#aee3ea37f4f505980157cf93a84687bcb">ControlMode</a> <a class="el" href="control_8h.html#aee3ea37f4f505980157cf93a84687bcb">ControlMode</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ControlMode enumerator. </p>
<p >to set the operation mode of the FOC driver </p>

</div>
</div>
<a id="a646bef2e4e0d58c4b2a1c3d3037475a4" name="a646bef2e4e0d58c4b2a1c3d3037475a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a646bef2e4e0d58c4b2a1c3d3037475a4">&#9670;&#160;</a></span>Coordinates</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct_components.html">Components</a> <a class="el" href="control_8h.html#a646bef2e4e0d58c4b2a1c3d3037475a4">Coordinates</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Coordinates components structure. </p>
<p >abc, alpha/beta, d/q </p>

</div>
</div>
<a id="aa7c4fecf4e12490cdae6a6a0abd3959e" name="aa7c4fecf4e12490cdae6a6a0abd3959e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7c4fecf4e12490cdae6a6a0abd3959e">&#9670;&#160;</a></span>DRV_GAIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef enum <a class="el" href="control_8h.html#a4fe62c345b7ce33aac126a260c5a82fb">DRV_GAIN</a> <a class="el" href="control_8h.html#a4fe62c345b7ce33aac126a260c5a82fb">DRV_GAIN</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>DRV8302 amplification gain enumerator. </p>
<p >10V/V or 40V/V </p>

</div>
</div>
<a id="a7381bd99b9f8d665d55ffc97eedc9e9d" name="a7381bd99b9f8d665d55ffc97eedc9e9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7381bd99b9f8d665d55ffc97eedc9e9d">&#9670;&#160;</a></span>PID_para</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct_p_i_d__para.html">PID_para</a> <a class="el" href="struct_p_i_d__para.html">PID_para</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PID parameter structure. </p>
<p >pid parameters and target, error, previous error, and sum of error </p>

</div>
</div>
<a id="a05445b981aabc15fe58b2aa04cc007be" name="a05445b981aabc15fe58b2aa04cc007be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05445b981aabc15fe58b2aa04cc007be">&#9670;&#160;</a></span>UserAPP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef enum <a class="el" href="control_8h.html#ab8fd4796026dfcd8e06f047989acb66a">UserAPP</a> <a class="el" href="control_8h.html#ab8fd4796026dfcd8e06f047989acb66a">UserAPP</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>UserAPP enumerator. </p>
<p >to set different user applications of the FOC driver </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="aee3ea37f4f505980157cf93a84687bcb" name="aee3ea37f4f505980157cf93a84687bcb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee3ea37f4f505980157cf93a84687bcb">&#9670;&#160;</a></span>ControlMode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="control_8h.html#aee3ea37f4f505980157cf93a84687bcb">ControlMode</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ControlMode enumerator. </p>
<p >to set the operation mode of the FOC driver </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="aee3ea37f4f505980157cf93a84687bcbad3fa9ae9431d6cb1772f9d9df48cab19" name="aee3ea37f4f505980157cf93a84687bcbad3fa9ae9431d6cb1772f9d9df48cab19"></a>Idle&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aee3ea37f4f505980157cf93a84687bcba2891de101c03df22f3bf8137f8622908" name="aee3ea37f4f505980157cf93a84687bcba2891de101c03df22f3bf8137f8622908"></a>Speed&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aee3ea37f4f505980157cf93a84687bcba0ca2444163688098d8e674e31fb11397" name="aee3ea37f4f505980157cf93a84687bcba0ca2444163688098d8e674e31fb11397"></a>Position&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aee3ea37f4f505980157cf93a84687bcbaa1ffbb212863410b17ce950709b7caa1" name="aee3ea37f4f505980157cf93a84687bcbaa1ffbb212863410b17ce950709b7caa1"></a>Torque&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="control_8h_source.html#l00059">59</a> of file <a class="el" href="control_8h_source.html">control.h</a>.</p>

</div>
</div>
<a id="a4fe62c345b7ce33aac126a260c5a82fb" name="a4fe62c345b7ce33aac126a260c5a82fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fe62c345b7ce33aac126a260c5a82fb">&#9670;&#160;</a></span>DRV_GAIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="control_8h.html#a4fe62c345b7ce33aac126a260c5a82fb">DRV_GAIN</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>DRV8302 amplification gain enumerator. </p>
<p >10V/V or 40V/V </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a4fe62c345b7ce33aac126a260c5a82fba30f3f2fba31dab5fa94c1979df5b3648" name="a4fe62c345b7ce33aac126a260c5a82fba30f3f2fba31dab5fa94c1979df5b3648"></a>DRV_GAIN_10&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a4fe62c345b7ce33aac126a260c5a82fba003ad48d1b5cdccf078d183a8ebb6660" name="a4fe62c345b7ce33aac126a260c5a82fba003ad48d1b5cdccf078d183a8ebb6660"></a>DRV_GAIN_40&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="control_8h_source.html#l00073">73</a> of file <a class="el" href="control_8h_source.html">control.h</a>.</p>

</div>
</div>
<a id="ab8fd4796026dfcd8e06f047989acb66a" name="ab8fd4796026dfcd8e06f047989acb66a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8fd4796026dfcd8e06f047989acb66a">&#9670;&#160;</a></span>UserAPP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="control_8h.html#ab8fd4796026dfcd8e06f047989acb66a">UserAPP</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>UserAPP enumerator. </p>
<p >to set different user applications of the FOC driver </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ab8fd4796026dfcd8e06f047989acb66aacc842255ac43e600deac25fefd0fdb0a" name="ab8fd4796026dfcd8e06f047989acb66aacc842255ac43e600deac25fefd0fdb0a"></a>Drag&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab8fd4796026dfcd8e06f047989acb66aa436ecffb0346b444ef8e03489844ebf3" name="ab8fd4796026dfcd8e06f047989acb66aa436ecffb0346b444ef8e03489844ebf3"></a>ForceFeedback&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab8fd4796026dfcd8e06f047989acb66aaab57132cff95cd4bb6b65a486c127dfb" name="ab8fd4796026dfcd8e06f047989acb66aaab57132cff95cd4bb6b65a486c127dfb"></a>Switch&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab8fd4796026dfcd8e06f047989acb66aae72db1ad60dbc5ad7dbcb42d6035038f" name="ab8fd4796026dfcd8e06f047989acb66aae72db1ad60dbc5ad7dbcb42d6035038f"></a>SpaceWalk&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="control_8h_source.html#l00066">66</a> of file <a class="el" href="control_8h_source.html">control.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a8a4f56dcb39e5926827ed0907e6a8459" name="a8a4f56dcb39e5926827ed0907e6a8459"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a4f56dcb39e5926827ed0907e6a8459">&#9670;&#160;</a></span>ADCFilter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ADCFilter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Filter the sampled current </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle motor instance handler </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td><br  />
 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="a0b27b50e40405c6fc149078e10387372" name="a0b27b50e40405c6fc149078e10387372"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b27b50e40405c6fc149078e10387372">&#9670;&#160;</a></span>ADCSample()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ADCSample </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Current sampling function, once called, retrieve one set of sampled data from DMA Data stored in mHandle-&gt;Current called in timer callback function every control period </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle motor instance handler </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td><br  />
 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="a06324f7942b9d7b3b74ce9eae71dad39" name="a06324f7942b9d7b3b74ce9eae71dad39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06324f7942b9d7b3b74ce9eae71dad39">&#9670;&#160;</a></span>AnglePID()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AnglePID </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Angle loop PID calculation, calculate target speed with integral limiter </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle motor instance handler </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td>SetSpeedTarget(mHandle, target) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 Bug fixed by Alfred John (Zzx) on 04-Sept-2022 used 'SetSpeedTarget(mHandle, target);' instead of directly assign target speed to prevent over speed. </dd></dl>

</div>
</div>
<a id="a16576dccb7e1137b80a15a0259b77eb6" name="a16576dccb7e1137b80a15a0259b77eb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16576dccb7e1137b80a15a0259b77eb6">&#9670;&#160;</a></span>calcAngle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int calcAngle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: [Auxiliary Debug Function] calculate electric angle from Valpha and Vbeta </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle motor instance handler </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td><br  />
 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: electric angle [range 0-4096] </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="a378d01f7b019cd1abfe5745c3c0c5e1f" name="a378d01f7b019cd1abfe5745c3c0c5e1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a378d01f7b019cd1abfe5745c3c0c5e1f">&#9670;&#160;</a></span>ClarkeTransform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ClarkeTransform </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="control_8h.html#a646bef2e4e0d58c4b2a1c3d3037475a4">Coordinates</a> *&#160;</td>
          <td class="paramname"><em>pComponents</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Clarke Transformation function, convert abc to alpha beta </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>pComponents coordinates pointer (pComponents-&gt;a, pComponents-&gt;b, pComponents-&gt;c) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td>pComponents coordinates pointer (pComponents-&gt;alpha, pComponents-&gt;beta) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="a6907fe9118a5749f9ef88ccc2888fc5d" name="a6907fe9118a5749f9ef88ccc2888fc5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6907fe9118a5749f9ef88ccc2888fc5d">&#9670;&#160;</a></span>CurrentReconstruction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CurrentReconstruction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Reconstruct the sampled current from 2 phases to three phases </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle motor instance handler </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td><br  />
 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="a7eb418de90bcd7d3f2faf0075c9d88f3" name="a7eb418de90bcd7d3f2faf0075c9d88f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7eb418de90bcd7d3f2faf0075c9d88f3">&#9670;&#160;</a></span>DC_Calibration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DC_Calibration </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Calibrate the DC offset of the current shunt amplifier should be called after <a class="el" href="control_8h.html#a74b8d54f398d5cace9878611ddda252b" title=": Pull up the ENGATE pin of the DRV8302 to activate the gate">EnableGate()</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle motor instance handler </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td><br  />
 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: electric angle [range 0-4096] </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 04-Sept-2022 </dd></dl>

</div>
</div>
<a id="a5cde34a6778b1b8e9d106a8b94405cd2" name="a5cde34a6778b1b8e9d106a8b94405cd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cde34a6778b1b8e9d106a8b94405cd2">&#9670;&#160;</a></span>dq2SVPWM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dq2SVPWM </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Generate SVPWM directly from dq voltage </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle motor instance handler </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td><br  />
 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="a74b8d54f398d5cace9878611ddda252b" name="a74b8d54f398d5cace9878611ddda252b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74b8d54f398d5cace9878611ddda252b">&#9670;&#160;</a></span>EnableGate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EnableGate </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Pull up the ENGATE pin of the DRV8302 to activate the gate </p>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="a3833cbec98df3e6c130c4841b8401d70" name="a3833cbec98df3e6c130c4841b8401d70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3833cbec98df3e6c130c4841b8401d70">&#9670;&#160;</a></span>FOC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FOC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: FOC loop funtion, including electric angle conversion, phase current filtering, Clarke/Park transformation, PID calculation, and SVPWM generation Called in ADC_DMA callback every control period </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle motor instance handler </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td><br  />
 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="a8d782bbdb4cf49779abe695b1bc32b43" name="a8d782bbdb4cf49779abe695b1bc32b43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d782bbdb4cf49779abe695b1bc32b43">&#9670;&#160;</a></span>FOCcheck()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FOCcheck </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: [Auxiliary Debug Function] call to print FOC PID parameters </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle motor instance handler </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td>mHandle-&gt;idPID, mHandle-&gt;iqPID, mHandle-&gt;speedPID, mHandle-&gt;anglePID </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="adab12f80393f46ebe1732964a965ffff" name="adab12f80393f46ebe1732964a965ffff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adab12f80393f46ebe1732964a965ffff">&#9670;&#160;</a></span>GainSelection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GainSelection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="control_8h.html#a4fe62c345b7ce33aac126a260c5a82fb">DRV_GAIN</a>&#160;</td>
          <td class="paramname"><em>gain</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Select the gain of the buit-in amplifier of DRV8302 If GAIN = LOW, the internal current shunt amplifiers have a gain of 10V/V. If GAIN = HIGH, the current shunt amplifiers have a gain of 40V/V </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>gain DRV_GAIN_10, DRV_GAIN_40 <br  />
 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="a121e9fcddd5f7811aeeccb023ab60751" name="a121e9fcddd5f7811aeeccb023ab60751"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a121e9fcddd5f7811aeeccb023ab60751">&#9670;&#160;</a></span>getEangle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getEangle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Calculate electric angle from mechanical angle, store in mHandle-&gt;E_angle </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle motor instance handler </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td>mHandle-&gt;E_angle </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="a96353709b0ece65a0f458f13f7ebd35b" name="a96353709b0ece65a0f458f13f7ebd35b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96353709b0ece65a0f458f13f7ebd35b">&#9670;&#160;</a></span>GetSector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GetSector </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Calculate the sector of the target space voltage vector </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle-&gt;Voltage.alpha, mHandle-&gt;Voltage.beta </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td>mHandle-&gt;sector </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="a3f371a9588ee8097b54b5893c53a310c" name="a3f371a9588ee8097b54b5893c53a310c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f371a9588ee8097b54b5893c53a310c">&#9670;&#160;</a></span>getSpeed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getSpeed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Calculate the motor speed in rpm, store in mHandle-&gt;speed </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle motor instance handler </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td>mHandle-&gt;speed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="ae4de542701bd589dcf40374765b978a2" name="ae4de542701bd589dcf40374765b978a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4de542701bd589dcf40374765b978a2">&#9670;&#160;</a></span>GetSVPWM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GetSVPWM </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Original SVPWM calculation function using complex numbers, slow </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td><br  />
 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td><br  />
 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="a412e84f409f4dc2bfbc19a3eccca4570" name="a412e84f409f4dc2bfbc19a3eccca4570"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a412e84f409f4dc2bfbc19a3eccca4570">&#9670;&#160;</a></span>IdPID()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IdPID </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Current loop Id PID calculation, calculate target Vd from Id with current kalman filter, integral limiter, and over voltage limiter </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle motor instance handler </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td>mHandle-&gt;Voltage.d </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="a7658aa110661b90ebb23f29cfbc73b92" name="a7658aa110661b90ebb23f29cfbc73b92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7658aa110661b90ebb23f29cfbc73b92">&#9670;&#160;</a></span>InvPark()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void InvPark </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="control_8h.html#a646bef2e4e0d58c4b2a1c3d3037475a4">Coordinates</a> *&#160;</td>
          <td class="paramname"><em>pComponents</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>theta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Inverse Park Transformation function, convert d, q to alpha, beta Original park: q leads d axis by 90 deg Modified park: d leads q axis by 90 deg </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>pComponents coordinates pointer (pComponents-&gt;d, pComponents-&gt;q) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td>pComponents coordinates pointer (pComponents-&gt;alpha, pComponents-&gt;beta) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="a2773bdccd83bd5da909b5578439d569b" name="a2773bdccd83bd5da909b5578439d569b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2773bdccd83bd5da909b5578439d569b">&#9670;&#160;</a></span>IqPID()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IqPID </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Current loop Iq PID calculation, calculate target Vq from Iq with current kalman filter, integral limiter, and over voltage limiter </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle motor instance handler </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td>mHandle-&gt;Voltage.q </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="a9ca0cc7c05bfaf12c86799a2d71c8ede" name="a9ca0cc7c05bfaf12c86799a2d71c8ede"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ca0cc7c05bfaf12c86799a2d71c8ede">&#9670;&#160;</a></span>ModeSelection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ModeSelection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="control_8h.html#aee3ea37f4f505980157cf93a84687bcb">ControlMode</a>&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Mode selection function </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle motor instance handler </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mode operation mode </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="a39d7de953ea95e29b89b7294a304fca1" name="a39d7de953ea95e29b89b7294a304fca1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39d7de953ea95e29b89b7294a304fca1">&#9670;&#160;</a></span>ModulationLimit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ModulationLimit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Overmodulation limiting function, prevent overmodulation </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle-&gt;T1, mHandle-&gt;T2 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td>mHandle-&gt;T1, mHandle-&gt;T2 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="aa05889183d3dd27313d91a9f5c6105e9" name="aa05889183d3dd27313d91a9f5c6105e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa05889183d3dd27313d91a9f5c6105e9">&#9670;&#160;</a></span>MotorCalibration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MotorCalibration </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Calibrate motor when power on Measure the angle offset between encoder 0 deg and motor electrical 0 deg(phase a 100%) Angle_E = (Angle_M - Offset)*nPolePairs </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle motor instance handler </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="a10d4a5658201a6cb630bbe063d898472" name="a10d4a5658201a6cb630bbe063d898472"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10d4a5658201a6cb630bbe063d898472">&#9670;&#160;</a></span>MotorInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MotorInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ADC_HandleTypeDef&#160;</td>
          <td class="paramname"><em>hadc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TIM_HandleTypeDef&#160;</td>
          <td class="paramname"><em>hDriver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TIM_HandleTypeDef&#160;</td>
          <td class="paramname"><em>hEncoder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">I2C_HandleTypeDef&#160;</td>
          <td class="paramname"><em>hIICEncoder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="control_8h.html#aee3ea37f4f505980157cf93a84687bcb">ControlMode</a>&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: <a class="el" href="struct_motor.html" title="Motor parameter structure.">Motor</a> initialization function </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle motor instance handler </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>hadc current sampling adc handler </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>hDriver driver timer handler (set the control frequency) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>hEncoder PWM encoder timer handler </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>hIICEncoder I2C encoder handler </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mode initial operation mode </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: void </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="a86ebf8db552e7de7117d19c4b32ce6af" name="a86ebf8db552e7de7117d19c4b32ce6af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86ebf8db552e7de7117d19c4b32ce6af">&#9670;&#160;</a></span>MotorOpenLoop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MotorOpenLoop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: openloop drag control </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle motor instance handler </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td><br  />
 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="a78b6d2cd4422b49b7ea838ce02d4bbcd" name="a78b6d2cd4422b49b7ea838ce02d4bbcd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78b6d2cd4422b49b7ea838ce02d4bbcd">&#9670;&#160;</a></span>ParkTransform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ParkTransform </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="control_8h.html#a646bef2e4e0d58c4b2a1c3d3037475a4">Coordinates</a> *&#160;</td>
          <td class="paramname"><em>pComponents</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>theta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Park Transformation function, convert alpha, beta to d, q Original park: q leads d axis by 90 deg Modified park: d leads q axis by 90 deg </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>pComponents coordinates pointer (pComponents-&gt;alpha, pComponents-&gt;beta) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td>pComponents coordinates pointer (pComponents-&gt;d, pComponents-&gt;q) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="a88ae85a44012b8f171bd1fcd4064ace0" name="a88ae85a44012b8f171bd1fcd4064ace0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88ae85a44012b8f171bd1fcd4064ace0">&#9670;&#160;</a></span>SetAnglePID()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetAnglePID </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>kp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>ki</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>kd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Set angle loop PID parameters </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle motor instance handler </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>kp, ki, kd </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td>mHandle-&gt;anglePID </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="ad5d2a006a653c2eb76f455b9277d8729" name="ad5d2a006a653c2eb76f455b9277d8729"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5d2a006a653c2eb76f455b9277d8729">&#9670;&#160;</a></span>SetAngleTarget()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetAngleTarget </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>Target</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Set absolute target angle, only single-turn (0-360 deg) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle motor instance handler </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>Target </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td>mHandle-&gt;anglePID.target </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="a84d9a96ad0f0c9549bb4d32581957441" name="a84d9a96ad0f0c9549bb4d32581957441"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84d9a96ad0f0c9549bb4d32581957441">&#9670;&#160;</a></span>SetCurrentPID()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetCurrentPID </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>kp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>ki</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>kd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Set PID parameters of both d,q current loop </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle motor instance handler </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>kp, ki, kd </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td>mHandle-&gt;iqPID, mHandle-&gt;idPID </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="ac84226769ac245e2efd1ad7811489a68" name="ac84226769ac245e2efd1ad7811489a68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac84226769ac245e2efd1ad7811489a68">&#9670;&#160;</a></span>SetCurrentTarget()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetCurrentTarget </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>idTarget</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>iqTarget</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Set target id, iq </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle motor instance handler </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>idTarget, iqTarget </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td>mHandle-&gt;idPID.target, mHandle-&gt;iqPID.target </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="a8db1fd960af01c3aa2bfb514e1def9d5" name="a8db1fd960af01c3aa2bfb514e1def9d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8db1fd960af01c3aa2bfb514e1def9d5">&#9670;&#160;</a></span>SetIncrementAngle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetIncrementAngle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>Target</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Set increment target angle, the incremental angle is also restricted in (0-360 deg) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle motor instance handler </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td>SetAngleTarget(mHandle,Target); </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="a21066fe1f928c7c279fbcab34c8d094b" name="a21066fe1f928c7c279fbcab34c8d094b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21066fe1f928c7c279fbcab34c8d094b">&#9670;&#160;</a></span>SetMotorParam()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetMotorParam </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>DC_supply</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>polePairs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>MaxCurrent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>MaxSpeed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Set motor parameters </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle motor instance handler </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>V DC supply voltage </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>phase number of phase </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>polePairs number of pole pairs </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>MaxCurrent maximum current -&gt; maximum phase current </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>MaxSpeed maximum speed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="a9c1255dcaf68017b30f5d2132e2a5a6d" name="a9c1255dcaf68017b30f5d2132e2a5a6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c1255dcaf68017b30f5d2132e2a5a6d">&#9670;&#160;</a></span>SetSpeedPID()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetSpeedPID </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>kp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>ki</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>outMax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Set speed loop PID parameters and the speed limit </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle motor instance handler </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>kp, ki, kd, outMax </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td>mHandle-&gt;speedPID, mHandle-&gt;SpeedLimit </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="aa16906f85af7a938b4cecb1b76953762" name="aa16906f85af7a938b4cecb1b76953762"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa16906f85af7a938b4cecb1b76953762">&#9670;&#160;</a></span>SetSpeedTarget()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetSpeedTarget </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>Target</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Set target motor speed, with over speed limit </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle motor instance handler </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>Target </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td>mHandle-&gt;speedPID.target </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 Bug fixed by Alfred John (Zzx) on 04-Sept-2022 added negative over speed judgement </dd></dl>

</div>
</div>
<a id="adf18f98940d1b08559520b06d6ff405c" name="adf18f98940d1b08559520b06d6ff405c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf18f98940d1b08559520b06d6ff405c">&#9670;&#160;</a></span>SetSVPWM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetSVPWM </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: MOSFET dwelling time calculation function, to generate SVPWM </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle motor instance handler </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td>mHandle-&gt;Ta, mHandle-&gt;Tb, mHandle-&gt;Tc </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="a7d7728f0aacb1fbae2a6accff6ae7f09" name="a7d7728f0aacb1fbae2a6accff6ae7f09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d7728f0aacb1fbae2a6accff6ae7f09">&#9670;&#160;</a></span>SpeedPID()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SpeedPID </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Speed loop PID calculation, set target Id = 0, calculate target Iq from speed with integral limiter, and over current limiter </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle motor instance handler </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td>mHandle-&gt;iqPID.target </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
<a id="a503ae511083e4a1a1c330a01cd21cf1a" name="a503ae511083e4a1a1c330a01cd21cf1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a503ae511083e4a1a1c330a01cd21cf1a">&#9670;&#160;</a></span>UserAPPSelection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UserAPPSelection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_motor.html">Motor</a> *&#160;</td>
          <td class="paramname"><em>mHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="control_8h.html#ab8fd4796026dfcd8e06f047989acb66a">UserAPP</a>&#160;</td>
          <td class="paramname"><em>app</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: user application selection function </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>mHandle motor instance handler </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname"></td><td>app user application </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<dl class="section user"><dt>Change logs</dt><dd>Created by Alfred John (Zzx) on 03-Sept-2022 </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
